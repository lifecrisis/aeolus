"""
This module prints a summary report for the accompanying "results.csv" file
generated by running experiment #02 on Spark.
"""


def print_record(record):
    """ Format and print a CSV record. """

    # TODO: re-format the output of this function to match this experiment
    fields = record.split(',')
    print "    Neighbors : %s" % fields[0] 
    print "    Power : %s" % fields[1] 
    print "    MARE : %s" % fields[2] 
    print "    RMSPE : %s" % fields[3] 


def main():
    """ Application main. """

    # load records from "results.csv"
    record_list = []
    with open('results.csv') as f:
        f.readline()
        record_list.extend(f) 
    record_list = map(lambda s: s.strip(), record_list)

    # TODO: average the results across partitions before optimizing

    # TODO(jf): remove unnecessary fields from records

    # print header
    print "\n======================================================"
    print "Summary for Experiment #01:"

    # sort records by MARE and print optimal record
    record_list.sort(key=lambda s: float(s.split(',')[2]))
    print "\nOptimal MARE result:"
    print_record(record_list[0])

    # sort records by RMSPE and print optimal record
    record_list.sort(key=lambda s: float(s.split(',')[3]))
    print "\nOptimal RMSPE result:"
    print_record(record_list[0])

    print "\nEND PROGRAM"
    print "======================================================\n"


if __name__ == "__main__":
    main()
