"""
This module prints a summary report for the accompanying "results.csv" file
generated by running experiment #04 on Spark. This "summary #1" is only
one of the two summaries generated. The second summary uses the analysis
of partitions two and three in computing the optimal results.
"""


def print_record(record):
    """ Format and print a CSV record. """

    fields = record.split(',')
    print "    Folds : %s" % fields[2]
    print "    Neighbors : %s" % fields[3]
    print "    Power : %s" % fields[4]
    print "    Time Scale : %s" % fields[5]
    print "    Alpha : %s" % fields[6]
    print "    Bags : %s" % fields[7]
    print "    MARE : %s" % fields[8]
    print "    RMSPE : %s" % fields[9]


def main():
    """ Application main. """

    with open('results.csv', 'r') as results_file:
        record_list = list(results_file)
    record_list = [s.strip() for s in record_list]

    # print header
    print "======================================================"
    print "Summary #1 for Experiment #04:"

    # sort records by MARE and print optimal record
    record_list.sort(key=lambda s: float(s.split(',')[8]))
    print "\nOptimal MARE result:"
    print_record(record_list[0])

    # sort records by RMSPE and print optimal record
    record_list.sort(key=lambda s: float(s.split(',')[9]))
    print "\nOptimal RMSPE result:"
    print_record(record_list[0])

    print "\nEND PROGRAM"
    print "======================================================"


if __name__ == "__main__":
    main()
